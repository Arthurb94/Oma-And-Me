<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- <link rel="stylesheet" href="style.css" /> -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <title>Combined Application</title>
    <style>
      @import "font/stylesheet.css";

      /* Global styles */
      html,
      body,
      p,
      button {
        margin: 0;
        padding: 0;
        line-height: 1.6;
        color: #333;
        height: 100%;
        overflow-x: hidden;
        font-family: "Euclid Circular B";
      }

      body {
        background-color: #ffffff;
        text-align: center;
      }

      /* Container */
      .page {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
        flex-wrap: wrap;
        align-content: center;
        background: white;

        border-radius: 10px;
        max-width: 600px;
        width: 100%;
        box-sizing: border-box;
      }

      .page-title {
        font-size: 27px;
        font-weight: 700;
        line-height: 34px;
        color: #000000;
      }

      .page-subtitle {
        font-size: 15px;
        line-height: 20px;
        color: #000000;
      }

      .page-description {
        font-weight: normal;
        font-size: 16px;
        line-height: 20px;
      }

      /* OVERLAY PAGE 1*/
      .overlay {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
      }

      .overlay-content {
        background-color: #f5f1e9;
        padding: 20px;
        width: 100%;
        max-width: 500px;
        position: relative;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
      }

      .overlay-content label {
        display: flex;
        align-items: flex-start;
        margin-bottom: 15px;
        font-size: 12px;
        line-height: 15px;
        text-align: left;
      }

      .overlay-content input[type="checkbox"] {
        margin-right: 10px;
        margin-top: 5px;
      }

      .text {
        display: inline;
        text-align: justify;
      }

      .underline {
        background-color: transparent;
        text-decoration: underline;
      }

      .container {
        background: white;
        padding: 2em;
        border-radius: 10px;
        max-width: 600px;
        width: 100%;
      }

      .progress-container {
        display: flex;
        justify-content: space-around;
        align-items: center;
        /* background-color: #f1f1f1; */
        padding: 10px 0;
        position: flex;
        width: 100%;

        left: 0;
      }

      .progress-step {
        width: 22%;
        height: 10px;
        background-color: lightgray;
        color: black;
        text-align: center;
        line-height: 30px;
        /* border-radius: 5px; */
        transition: background-color 0.3s, color 0.3s;
      }

      .progress-step.completed {
        background-color: #dad5c4;
        color: white;
      }

      .collapsible-container {
        margin: 20px;
        padding: 10px;
        border-top: 1px solid #000; /* Ligne au-dessus */
        border-bottom: 1px solid #000; /* Ligne en-dessous */
        width: 100%;
      }

      .collapsible-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
      }

      .guide-text {
        margin: 0;
        font-weight: 500;
        font-size: 16px;
        line-height: 20px;
      }

      .collapsible-button {
        background-color: transparent;
        border: none;
        font-size: 20px;
        cursor: pointer;
      }

      .collapsible-content {
        display: none; /* Masqué par défaut */
        padding-top: 10px;
        width: 100%;
        text-align: justify;
        font-size: 16px;
        line-height: 20px;
      }

      .collapsible-content.expanded {
        display: block; /* Affiche le contenu lorsqu'il est étendu */
      }

      .collapsed-content {
        margin-bottom: 20px;
      }

      .photo-container {
        display: flex;
        justify-content: center;
        align-items: center;
        border: 1px solid black;
        width: 350px;
        margin: 0 auto;
        margin-bottom: 12px;
        margin-top: 12px;
        flex-direction: column;
      }

      .photo {
        width: 100%;
        height: auto;
        object-fit: cover;
      }

      /* Gender selection */
      .gender-selection {
        text-align: left;
        justify-content: space-around;
        margin: 1em 0;
      }

      .gender-btn {
        background-color: white;
        color: black;
        border: 1px solid black;
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        margin: 5px;
        width: 100%;
      }

      .selected {
        background-color: black;
        color: white;
      }

      .gender-btn:hover {
        background-color: black;
        color: white;
      }

      /* Privacy policy */
      .privacy-policy {
        font-size: 0.8em;
        margin-top: 1em;
      }

      .privacy-policy a {
        color: #007bff;
        text-decoration: none;
      }

      .privacy-policy a:hover {
        text-decoration: underline;
      }

      /* Photo example */
      .photo-example {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px 0px 20px 0px;
      }

      .photo-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
      }

      .icon {
        width: 24px;
        height: 24px;
      }

      /* Buttons */
      .continue-btn,
      .capture-btn,
      .retake-btn,
      .confirm-btn,
      .button-group {
        width: 100%;
        background-color: black;
        color: white;
        border: 1px solid black;
        padding: 10px 20px;
        font-size: 16px;
        font-weight: 700;
        cursor: pointer;
        margin: 5px;
        justify-content: center;
        align-items: center;
      }

      video {
        width: 100%;
        height: 100%;
        border-radius: 10px;
        margin: 1em 0;
      }

      .video-container {
        position: relative;
        width: 100%;
        /* max-width: 600px; Ajuster selon les besoins */
        margin: 0 auto;
      }

      #videoFront {
        width: 100%;
        height: auto; /* Assure que la hauteur est proportionnelle à la largeur */
      }

      .overlay-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 0.5; /* Ajuster l'opacité selon les besoins */
        pointer-events: none; /* Assure que l'image ne gêne pas les contrôles de la vidéo */
        object-fit: cover; /* Assure que l'image couvre tout l'élément sans déformation */
      }

      /* Photo preview */
      .photo-preview {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-around;
        margin: 1em 0;
      }

      .photo-preview div {
        margin: 0.5em;
        text-align: center;
        padding: 10px;
      }

      .photo-preview img {
        height: auto;
        padding: 10px 0px 10px 0px;
      }

      /* Loader */
      .loader {
        border: 8px solid #f3f3f3;
        border-top: 8px solid #007bff;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        animation: spin 2s linear infinite;
        margin: 0 auto 1em auto;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Media Queries */
      @media (max-width: 600px) {
        .container {
          padding: 1em;
        }

        .gender-selection {
          flex-direction: column;
          gap: 1em;
        }
      }

      .iphone {
        background-color: #ffffff;
        width: 100%;
        max-width: 390px;
        min-height: auto;
        margin: 0 auto;
        padding: 20px;
      }

      .iphone .div {
        background-color: #ffffff;
        padding-bottom: 100px;
      }

      .status-number {
        position: absolute;
        left: 0; /* Aligne à gauche */
        top: 0; /* Optionnel: Aligne en haut */
      }

      .status-bar {
        display: flex;
        justify-content: space-around;
        align-items: center;
        width: 100%;
        height: 9px;
        margin: 0px 0px 10px;
      }

      .status-rectangle {
        height: 10px;
        width: 22%;
        background-color: #dad5c4;
        margin: 0 2px;
        transition: background-color 0.3s, color 0.3s;
      }

      .analysis-result,
      .analysis-description,
      .analysis-title,
      .p {
        margin: 10px 0;
      }

      .content-div {
        padding: 20px;
        margin-bottom: 20px;
      }

      .img,
      .analysis-img,
      .issue-img,
      .solution-img {
        margin: 10px 0;
      }

      /* BLOC DES BARRES D'ÉTAT */
      .stage-scale {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        justify-content: flex-start;
        height: 250px;
        /* Fixez la hauteur du conteneur selon vos besoins */
        width: 100%;
        padding: 10px;
        background-color: #f5f1e9;
        box-sizing: border-box;
        margin-bottom: 10px;
      }

      .stage-header {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        margin-bottom: 20px;
      }

      .stage-title {
        font-size: 24px;
        font-weight: bold;
      }

      .stage-description {
        font-size: 16px;
        color: black;
        font-weight: bold;
      }

      .stage-bars {
        display: flex;
        flex-direction: row;
        align-items: flex-end;
        justify-content: space-around;
        width: 100%;
        height: 100%;
      }

      .stage-scale div {
        position: relative;
        border-radius: 3px;
      }

      .stage-scale-1 {
        height: 14%;
        width: 10%;
      }

      .stage-scale-2 {
        height: 28%;
        width: 10%;
      }

      .stage-scale-3 {
        height: 42%;
        width: 10%;
      }

      .stage-scale-4 {
        height: 56%;
        width: 10%;
      }

      .stage-scale-5 {
        height: 70%;
        width: 10%;
      }

      .stage-scale-6 {
        height: 84%;
        width: 10%;
      }

      .stage-scale-7 {
        height: 100%;
        width: 10%;
      }

      .stage-number {
        position: absolute;
        top: -25px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 14px;
        border: 0.5px dashed #000000;
        text-align: center;
      }

      .info-text {
        font-size: 14px;
        color: #000;
        padding-left: 35%;
      }

      .info-text i {
        margin-left: 5px;
      }

      /* BLOC FIABLILITÉ*/
      .fiability-container {
        background-color: #efeeec;
        padding: 20px;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .fiability-text {
        text-align: left;
        margin-right: 20px;
      }

      .fiability-title {
        font-size: 16px;
        font-weight: 600;
        line-height: 20px;
      }

      .fiability-description {
        font-size: 16px;
        font-weight: 400;
      }

      .fiability-score-box {
        position: relative;
        display: inline-block;
      }

      .fiability-score-box .img {
        display: block;
        width: 100%;
        height: 100%;
      }

      .fiability-score {
        font-size: 22px;
        margin-right: 10px;
        font-weight: 600;
        line-height: 27px;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }

      /* BLOC BOUTONS */
      .button-container {
        display: flex;
        justify-content: space-around;
        align-items: center;
        border-radius: 5px;
        box-sizing: border-box;
        margin: 10px;
      }

      .button-item {
        display: flex;
        align-items: center;
        margin: 0 10px;
      }

      .button-item img {
        margin-right: 10px;
      }

      .button-item button {
        font-size: 14px;
        font-weight: 700;
        border: none;
        background-color: white;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }

      .button-item button.active {
        font-weight: bold;
        text-decoration: underline;
      }

      /* BLOC ANALYSE*/
      #analysis,
      #issue,
      #solution {
        padding: 20px;
        border: 1px dashed #000;
        box-sizing: border-box;
      }

      #analysis p,
      #analysis .analysis-title,
      #analysis .analysis-description,
      #issue p,
      #issue .issues-title,
      #issue ul,
      #issue .issue-description,
      #issue .status-description #solution p,
      #solution .solution-title,
      #solution .solution-subtitle {
        text-align: left;
        margin: 0;
      }

      .analysis-title {
        font-size: 16px;
        font-weight: 600;
        line-height: 20px;
        margin-bottom: 10px;
      }

      .analysis-result {
        font-size: 16px;
        font-weight: 600;
        line-height: 20px;
        margin: 10px 0;
      }

      .result-container {
        position: relative;
        display: flex;
        align-items: center;
        text-align: left;
      }

      .analysis-ellipse-img {
        width: 31px;
        height: 31px;
        transform: translateY(-50%);
        margin-top: 30px;
        padding: 0px 10px 0px;
      }

      .analysis-description {
        margin-top: 10px;
        font-size: 14px;
        font-weight: 400;
        line-height: 17px;
      }

      .issues-title {
        font-size: 16px;
        font-weight: 600;
        line-height: 20px;
        margin-bottom: 10px;
      }

      #issue ul {
        list-style-type: disc;
        /* Affiche les puces pour la liste */
        margin: 10px 0;
        padding-left: 20px;
        /* Ajoute du padding pour le placement des puces */
      }

      #issue ul li {
        font-size: 16px;
        font-weight: 600;
        line-height: 20px;
        margin-bottom: 5px;
        /* Espace entre les éléments de la liste */
      }

      .hidden {
        display: none;
      }

      .issue-description {
        font-size: 14px;
        font-weight: 400;
        line-height: 17px;
        margin: 10px 0;
      }

      .issue-status-container {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        margin-top: 10px;
        background-color: #f5f1e9;
      }

      .issue-status-content {
        display: flex;
        align-items: center;
        padding: 20px 20px 10px 20px;
      }

      .issue-status-img {
        width: 15px;
        height: 15px;
        padding-right: 5px;
      }

      .issue-status {
        font-size: 16px;
        font-weight: 600;
        line-height: 20px;
      }

      .status-description {
        font-size: 14px;
        font-weight: 400;
        line-height: 17px;
        padding: 0px 20px 20px 20px;
      }

      .solution-title,
      .solution-subtitle {
        font-size: 16px;
        font-weight: 600;
        line-height: 20px;
        padding-bottom: 10px;
      }

      .solution-description-container {
        display: flex;
        align-items: flex-start;
        margin-bottom: 20px;
      }

      .solution-description {
        flex: 1;
        font-size: 14px;
        font-weight: 400;
        line-height: 17px;
        text-align: left;
        margin-right: 20px;
        padding-bottom: 10px;
      }

      .solution-description-img {
        width: 206px;
        height: auto;
        padding: 20px;
      }

      .solution-args-container {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .solution-arg {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
      }

      .solution-arg i,
      .solution-arg img {
        margin-right: 10px;
        /* Espace entre l'icône et le texte */
        width: 20px;
        /* Ajustez la taille des icônes si nécessaire */
        height: auto;
        /* Conservez les proportions des icônes */
      }

      .arg {
        font-size: 14px;
        font-weight: 400;
        line-height: 17px;
        text-align: left;
      }

      .redirect-button {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 45px;
        font-size: 16px;
        font-weight: 700;
        color: white;
        background-color: black;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        text-align: center;
      }

      .condition {
        font-style: italic;
        font-size: 12px;
        font-weight: 400;
        line-height: 10px;
        margin-top: 20px;
        text-align: center;
      }
    </style>
  </head>

  <body>
    <div class="iphone">
      <!-- Page 1: Select Gender -->
      <div id="page1" class="page">
        <div class="progress-container">
          <div class="progress-step completed"></div>
          <div class="progress-step"></div>
          <div class="progress-step"></div>
          <div class="progress-step"></div>
        </div>
        <div class="page-title">INFORMATIONS</div>
        <div class="page-subtitle">
          <b>
            Afin de vous fournir une analyse pertinente, nous vous demandons de
            bien vouloir indiquer votre sexe
          </b>
        </div>
        <div class="gender-selection">
          <p><b>Vous êtes:</b></p>
          <button class="gender-btn selected" onclick="selectGender('male')">
            <b>UN HOMME</b>
          </button>
          <button class="gender-btn" onclick="selectGender('female')">
            <b>UNE FEMME</b>
          </button>
        </div>
        <div class="page-description">
          Cette information est cruciale pour assurer la précision de l'analyse
        </div>
        <div class="overlay">
          <div id="privacy-overlay" class="overlay-content">
            <label class="overlay-label">
              <input type="checkbox" id="privacy-checkbox" />
              <span class="text">
                En téléchargeant votre photo dans notre outil d'IA, vous
                acceptez notre
                <mark class="underline">Politique de Confidentialité</mark>.
                Nous utilisons ces photos pour vous fournir une analyse
                personnalisée de votre perte de cheveux. Vos données restent
                totalement confidentielles et vos photos et ne seront pas
                stockées sur notre serveur.
              </span>
            </label>
            <button id="confirm-button" class="confirm-btn" disabled>
              Confirmer
            </button>
          </div>
        </div>
      </div>

      <!-- Page 2: Photo Instructions (Front View) -->
      <div id="page2" class="page" style="display: none">
        <div class="progress-container">
          <div class="progress-step completed"></div>
          <div class="progress-step completed"></div>
          <div class="progress-step"></div>
          <div class="progress-step"></div>
        </div>
        <div class="page-title">PRENEZ DES PHOTOS</div>
        <div class="page-subtitle">
          <b>
            Utilisez votre appareil photo pour prendre des photos nettes de vos
            cheveux
          </b>
        </div>
        <div class="photo-example">
          <div class="photo-grid">
            <img
              src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/front-ia.png?v=1721388052"
              alt="Photo 1"
              class="photo"
            />
            <img
              src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/top.png?v=1721387797"
              alt="Photo 2"
              class="photo"
            />
            <img
              src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/right.png?v=1721387797"
              alt="Photo 3"
              class="photo"
            />
            <img
              src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/left.png?v=1721387797"
              alt="Photo 4"
              class="photo"
            />
          </div>
        </div>
        <div class="collapsible-container">
          <div class="collapsible-header">
            <span class="guide-text">GUIDE DES PHOTOS</span>
            <button class="collapsible-button" onclick="toggleCollapsible()">
              +
            </button>
          </div>
          <div class="collapsible-content">
            <b>
              <div class="collapsed-content">
                Nous avons besoin au total de quatre photos pour évaluer votre
                stade et type de perte de cheveux : de face, du dessus et de
                chaque côté.
              </div>
            </b>
            <div class="collapsed-content">
              Centrez votre visage et votre cuir chevelu dans le cercle à
              l'écran. Assurez-vous que vos cheveux et le sommet de votre tête
              sont bien visibles. Aligner votre tête avec le cercle pour les
              photos de côté peut nécessiter quelques ajustements.
            </div>
          </div>
        </div>

        <button class="continue-btn" onclick="navigateTo('page3')">
          <b>COMMENCER</b>
        </button>
        <div class="bottum-text">
          Les images ne seront à aucun moment stockées sur un serveur.
        </div>
      </div>

      <!-- Page 3: Photo Instructions (Front View) -->
      <div id="page3" class="page" style="display: none">
        <div class="progress-container">
          <div class="progress-step completed"></div>
          <div class="progress-step completed"></div>
          <div class="progress-step"></div>
          <div class="progress-step"></div>
        </div>
        <h3>
          <img
            src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/camera.png?v=1721387796"
            alt="Camera Icon"
            class="icon"
          />
          Angle 1 : vue de face
        </h3>
        <div class="page-description">
          Prenez une photo de l'avant de face pour donner une vue d'ensemble de
          vos cheveux
        </div>
        <div class="photo-container">
          Exemple
          <img
            src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/front-exemple.png?v=1721387797"
            id="exemple"
            class="photo"
          />
        </div>
        <button class="continue-btn" onclick="navigateTo('page4')">
          CONTINUER
        </button>
      </div>

      <!-- Page 4: Take Front View Photo -->
      <div id="page4" class="page" style="display: none">
        <div class="video-container">
          <video id="videoFront" autoplay playsinline></video>
          <canvas id="canvasFront" style="display: none"></canvas>
          <img
            src="assets/overlay-image-front-top.png"
            class="overlay-image"
            alt="Overlay Image"
          />
        </div>
        <button id="captureBtnFront" class="capture-btn">
          <b>PRENDRE LA PHOTO</b>
        </button>
        <canvas id="canvasFront" style="display: none"></canvas>
        <img
          id="previewFront"
          style="
            display: none;
            width: 100%;
            border-radius: 5px;
            margin-bottom: 10px;
          "
          alt="Front View Preview"
        />
        <button
          id="retakeBtnFront"
          class="retake-btn"
          onclick="retakePhoto('front', true)"
          style="display: none"
        >
          REPRENDRE
        </button>
        <button
          id="confirmBtnFront"
          class="confirm-btn"
          onclick="confirmPhoto('front')"
          style="display: none"
        >
          CONFIRMER
        </button>
      </div>

      <!-- Page 5: Photo Instructions (Top View) -->
      <div id="page5" class="page" style="display: none">
        <div class="progress-container">
          <div class="progress-step completed"></div>
          <div class="progress-step completed"></div>
          <div class="progress-step"></div>
          <div class="progress-step"></div>
        </div>
        <h3>
          <img
            src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/camera.png?v=1721387796"
            alt="Camera Icon"
            class="icon"
          />
          Angle 2 : vue du dessus
        </h3>
        <div class="page-description">
          Prenez une photo du dessus de votre cuir cheveulu
        </div>
        <div class="photo-container">
          Exemple
          <img
            src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/Capture_d_ecran_2024-07-30_094956.png?v=1722325835"
            id="exemple"
            class="photo"
          />
        </div>
        <button class="continue-btn" onclick="navigateTo('page6')">
          CONTINUER
        </button>
      </div>

      <!-- Page 6: Take Top View Photo -->
      <div id="page6" class="page" style="display: none">
        <div class="video-container">
          <video id="videoTop" autoplay playsinline></video>
          <canvas id="canvasTop" style="display: none"></canvas>
          <img
            src="assets/overlay-image-front-top.png"
            class="overlay-image"
            alt="Overlay Image"
          />
        </div>
        <button
          id="captureBtnTop"
          class="capture-btn"
          onclick="startCapture('top')"
        >
          <b>PRENDRE LA PHOTO</b>
        </button>
        <canvas id="canvasTop" style="display: none"></canvas>
        <img
          id="previewTop"
          style="
            display: none;
            width: 100%;
            border-radius: 5px;
            margin-bottom: 10px;
          "
          alt="Top View Preview"
        />
        <button
          id="retakeBtnTop"
          class="retake-btn"
          onclick="retakePhoto('top', true)"
          style="display: none"
        >
          REPRENDRE
        </button>
        <button
          id="confirmBtnTop"
          class="confirm-btn"
          onclick="confirmPhoto('top')"
          style="display: none"
        >
          CONFIRMER
        </button>
      </div>

      <!-- Page 7: Photo Instructions (Right View) -->
      <div id="page7" class="page" style="display: none">
        <div class="progress-container">
          <div class="progress-step completed"></div>
          <div class="progress-step completed"></div>
          <div class="progress-step"></div>
          <div class="progress-step"></div>
        </div>
        <h3>
          <img
            src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/camera.png?v=1721387796"
            alt="Camera Icon"
            class="icon"
          />
          Angle 3 : côté droit
        </h3>
        <div class="page-description">
          Prenez une photo du côté droit de vos cheveux, comme sur l'exemple
          ci-dessous
        </div>
        <div class="photo-container">
          Exemple
          <img
            src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/Capture_d_ecran_2024-07-30_094937.png?v=1722325836"
            id="exemple"
            class="photo"
          />
        </div>
        <button class="continue-btn" onclick="navigateTo('page8')">
          CONTINUER
        </button>
      </div>

      <!-- Page 8: Take Right View Photo -->
      <div id="page8" class="page" style="display: none">
        <div class="video-container">
          <video id="videoRight" autoplay playsinline></video>
          <canvas id="canvasRight" style="display: none"></canvas>
          <img
            src="assets/overlay-image-right-left.png"
            class="overlay-image"
            alt="Overlay Image"
          />
        </div>
        <button
          id="captureBtnRight"
          class="capture-btn"
          onclick="startCapture('right')"
        >
          <b>PRENDRE LA PHOTO</b>
        </button>
        <canvas id="canvasRight" style="display: none"></canvas>
        <img
          id="previewRight"
          style="
            display: none;
            width: 100%;
            border-radius: 5px;
            margin-bottom: 10px;
          "
          alt="Right View Preview"
        />
        <button
          id="retakeBtnRight"
          class="retake-btn"
          onclick="retakePhoto('right', true)"
          style="display: none"
        >
          REPRENDRE
        </button>
        <button
          id="confirmBtnRight"
          class="confirm-btn"
          onclick="confirmPhoto('right')"
          style="display: none"
        >
          CONFIRMER
        </button>
      </div>

      <!-- Page 9: Photo Instructions (Left View) -->
      <div id="page9" class="page" style="display: none">
        <div class="progress-container">
          <div class="progress-step completed"></div>
          <div class="progress-step completed"></div>
          <div class="progress-step"></div>
          <div class="progress-step"></div>
        </div>
        <h3>
          <img
            src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/camera.png?v=1721387796"
            alt="Camera Icon"
            class="icon"
          />
          Angle 4 : côté gauche
        </h3>
        <div class="page-description">
          Prenez une photo du côté gauche de vos cheveux, comme sur l'exemple
          ci-dessous
        </div>
        <div class="photo-container">
          Exemple
          <img
            src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/Capture_d_ecran_2024-07-30_094924.png?v=1722325835"
            id="exemple"
            class="photo"
          />
        </div>
        <button class="continue-btn" onclick="navigateTo('page10')">
          CONTINUER
        </button>
      </div>

      <!-- Page 10: Take Left View Photo -->
      <div id="page10" class="page" style="display: none">
        <div class="video-container">
          <video id="videoLeft" autoplay playsinline></video>
          <canvas id="canvasLeft" style="display: none"></canvas>
          <img
            src="assets/overlay-image-right-left.png"
            class="overlay-image"
            alt="Overlay Image"
          />
        </div>
        <button
          id="captureBtnLeft"
          class="capture-btn"
          onclick="startCapture('left')"
        >
          <b>PRENDRE LA PHOTO</b>
        </button>
        <canvas id="canvasLeft" style="display: none"></canvas>
        <img
          id="previewLeft"
          style="
            display: none;
            width: 100%;
            border-radius: 5px;
            margin-bottom: 10px;
          "
          alt="Left View Preview"
        />
        <button
          id="retakeBtnLeft"
          class="retake-btn"
          onclick="retakePhoto('left', true)"
          style="display: none"
        >
          REPRENDRE
        </button>
        <button
          id="confirmBtnLeft"
          class="confirm-btn"
          onclick="confirmPhoto('left')"
          style="display: none"
        >
          CONFIRMER
        </button>
      </div>

      <!-- Page 11: Review Photos -->
      <div id="page11" class="page" style="display: none">
        <div class="progress-container">
          <div class="progress-step completed"></div>
          <div class="progress-step completed"></div>
          <div class="progress-step completed"></div>
          <div class="progress-step"></div>
        </div>
        <div class="page-title">VÉRIFIEZ VOS PHOTOS</div>
        <div class="page-subtitle">
          <b> Assurez-vous que vos photos sont correctement prises. </b>
        </div>

        <div class="page-description">
          <img />
          Des photos nettes et dans un environnement bien éclairé améliore
          l'exactitude de notre outil de détection alimenté par IA.
        </div>
        <div class="photo-preview">
          <div class="photo-container">
            <b> Angle 1 : vue de face </b>
            <img
              id="frontViewPreview"
              class="photo"
              src=""
              alt="Front View Photo"
            />
            <button
              id="retakeBtnFront"
              class="retake-btn"
              onclick="retakePhoto('front', true)"
            >
              REPRENDRE LA PHOTO
            </button>
          </div>
          <div class="photo-container">
            <b> Angle 2 : vue du dessus </b>
            <img
              id="topViewPreview"
              class="photo"
              src=""
              alt="Top View Photo"
            />
            <button
              id="retakeBtnTop"
              class="retake-btn"
              onclick="retakePhoto('top', true)"
            >
              REPRENDRE LA PHOTO
            </button>
          </div>
          <div class="photo-container">
            <b> Angle 3 : coté droit </b>
            <img
              id="rightViewPreview"
              class="photo"
              src=""
              alt="Right View Photo"
            />
            <button
              id="retakeBtnRight"
              class="retake-btn"
              onclick="retakePhoto('right', true)"
            >
              REPRENDRE LA PHOTO
            </button>
          </div>
          <div class="photo-container">
            <b>Angle 4 : coté gauche</b>
            <img
              id="leftViewPreview"
              class="photo"
              src=""
              alt="Left View Photo"
            />
            <button
              id="retakeBtnLeft"
              class="retake-btn"
              onclick="retakePhoto('left', true)"
            >
              REPRENDRE LA PHOTO
            </button>
          </div>
        </div>
        <div class="overlay">
          <div id="privacy-overlay" class="overlay-content">
          <button class="button-group" onclick="sendPhotos()">
            OBTENIR MON DIAGNOSTIC
          </button>
          </div>
        </div>
        
      </div>

      <!-- Page 12: Loading -->
      <div id="page12" class="page" style="display: none">
        <div class="loader"></div>
        <h1>Loading, please wait...</h1>
      </div>

      <!-- Page 13: API Results -->
      <div id="page13" class="page" style="display: none">
        <div class="status-number">4/4</div>

        <div class="status-bar">
          <!-- TODO: MODIFIER CETTE PARTIE AVEC LA BARRE DE PROGRESSION -->
          <div class="status-rectangle"></div>
          <div class="status-rectangle"></div>
          <div class="status-rectangle"></div>
          <div class="status-rectangle"></div>
        </div>

        <div class="stage-scale">
          <div class="stage-header">
            <div id="stage-title" class="stage-title"></div>
            <div id="stage-description" class="stage-description"></div>
          </div>

          <div class="stage-bars">
            <div class="stage-scale-1">
              <div class="stage-number">1</div>
            </div>
            <div class="stage-scale-2">
              <div class="stage-number">2</div>
            </div>
            <div class="stage-scale-3">
              <div class="stage-number">3</div>
            </div>
            <div class="stage-scale-4">
              <div class="stage-number">4</div>
            </div>
            <div class="stage-scale-5">
              <div class="stage-number">5</div>
            </div>
            <div class="stage-scale-6">
              <div class="stage-number">6</div>
            </div>
            <div class="stage-scale-7">
              <div class="stage-number">7</div>
            </div>
          </div>

          <div class="info-text">
            Sur l’échelle de Nordwood
            <i class="fas fa-info-circle"></i>
          </div>
        </div>

        <div class="fiability-container">
          <div class="fiability-text">
            <div class="fiability-title">TAUX DE FIABILITÉ DU DIAGNOSTIC</div>
            <div class="fiability-description">Très élevé</div>
          </div>
          <div class="fiability-score-box">
            <img
              class="img"
              src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/fiability-circle.png?v=1722253852"
            />
            <div class="fiability-score">96%</div>
          </div>
        </div>

        <div class="button-container">
          <div class="button-item">
            <img
              class="analysis-img"
              src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/loop.png?v=1722253835"
            />
            <button
              class="analysis-button active"
              onclick="showText('analysis')"
            >
              ANALYSE
            </button>
          </div>
          <div class="button-item">
            <img
              class="issue-img"
              src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/target.png?v=1722253823"
            />
            <button class="issues-button" onclick="showText('issue')">
              ENJEUX
            </button>
          </div>
          <div class="button-item">
            <img
              class="solution-img"
              src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/Vector_6.png?v=1722197292"
            />
            <button class="solution-button" onclick="showText('solution')">
              SOLUTION
            </button>
          </div>
        </div>

        <div id="analysis" class="content-div">
          <div class="analysis-title">ANALYSE DE VOTRE RÉSULTAT</div>
          <div class="result-container">
            <img
              id="analysis-ellipse-img"
              class="analysis-ellipse-img"
              src="img/ellipse-3-2.svg"
            />
            <div id="analysis-result" class="analysis-result"></div>
          </div>
          <div id="analysis-description" class="analysis-description"></div>
        </div>

        <div id="issue" class="content-div" style="display: none">
          <div class="issues-title">ENJEUX</div>
          <ul>
            <li id="subtitle1" class="p">Sous-titre 1</li>
            <li id="subtitle2" class="p">Sous-titre 2</li>
          </ul>
          <p id="issue-description" class="issue-description"></p>
          <div class="issue-status-container">
            <div class="issue-status-content">
              <img
                id="issue-status-img"
                class="issue-status-img"
                src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/pouce.png?v=1722253747"
              />
              <div id="issue-status" class="issue-status"></div>
            </div>
            <p id="status-description" class="status-description"></p>
          </div>
        </div>

        <div id="solution" class="content-div" style="display: none">
          <div class="solution-title">SOLUTION</div>
          <div id="solution-subtitle" class="solution-subtitle"></div>
          <p id="solution-description" class="solution-description"></p>
          <img
            id="solution-description-img"
            class="solution-description-img"
            src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/kit.png?v=1722253778"
          />
          <div class="solution-args-container">
            <div class="solution-arg">
              <i class="fas fa-circle-check"></i>
              <p id="arg1" class="arg"></p>
            </div>
            <div class="solution-arg">
              <i class="fas fa-circle-check"></i>
              <p id="arg2" class="arg"></p>
            </div>
            <div class="solution-arg">
              <img
                class="icon3"
                src="https://cdn.shopify.com/s/files/1/0232/5961/1200/files/Group_55.png?v=1722197293"
              />
              <p id="arg3" class="arg"></p>
            </div>
          </div>
          <div id="button-text" class="redirect-button"></div>
          <p id="condition" class="condition"></p>
        </div>
      </div>
    </div>
    <script>
      // Navigation logic
      function navigateTo(pageId) {
        const pages = document.querySelectorAll(".page");
        const steps = document.querySelectorAll(".progress-step");

        pages.forEach((page) => (page.style.display = "none"));
        document.getElementById(pageId).style.display = "flex";

        // Mettre à jour les étapes de progression
        const pageIndex = Array.from(pages).findIndex(
          (page) => page.id === pageId
        );

        if (pageId === "page4") {
          startCapture("front");
        } else if (pageId === "page6") {
          startCapture("top");
        } else if (pageId === "page8") {
          startCapture("right");
        } else if (pageId === "page10") {
          startCapture("left");
        }
      }

      // Gender selection logic
      let selectedGender = "";

      function selectGender(gender) {
        selectedGender = gender;
        navigateTo("page2");
      }

      // Start and capture camera
      function startCapture(view) {
        const videoElement = document.getElementById(
          `video${capitalize(view)}`
        );
        const captureBtn = document.getElementById(
          `captureBtn${capitalize(view)}`
        );
        const retakeBtn = document.getElementById(
          `retakeBtn${capitalize(view)}`
        );
        const confirmBtn = document.getElementById(
          `confirmBtn${capitalize(view)}`
        );
        const previewElement = document.getElementById(
          `preview${capitalize(view)}`
        );

        navigator.mediaDevices
          .getUserMedia({ video: true })
          .then((stream) => {
            videoElement.srcObject = stream;
            videoElement.style.display = "block";
            captureBtn.style.display = "block";
            retakeBtn.style.display = "none";
            confirmBtn.style.display = "none";
            captureBtn.onclick = () => {
              const canvasElement = document.getElementById(
                `canvas${capitalize(view)}`
              );
              const context = canvasElement.getContext("2d");
              canvasElement.width = videoElement.videoWidth;
              canvasElement.height = videoElement.videoHeight;
              context.drawImage(
                videoElement,
                0,
                0,
                canvasElement.width,
                canvasElement.height
              );
              capturedPhotos[view] = canvasElement.toDataURL("image/jpeg");

              // Stop the video stream
              const tracks = stream.getTracks();
              tracks.forEach((track) => track.stop());
              videoElement.srcObject = null;

              videoElement.style.display = "none";
              previewElement.src = capturedPhotos[view];
              previewElement.style.display = "block";
              captureBtn.style.display = "none";
              retakeBtn.style.display = "block";
              confirmBtn.style.display = "block";
            };
          })
          .catch((error) => {
            console.error("Error accessing the camera:", error);
          });
      }

      // Photo capture logic
      let capturedPhotos = {
        front: null,
        top: null,
        right: null,
        left: null,
      };

      function retakePhoto(view) {
        capturedPhotos[view] = null;
        startCapture(view);
      }

      // Update button onclicks in page 10 to use the new parameter
      document.querySelector(
        "button[onclick=\"retakePhoto('front', true)\"]"
      ).onclick = () => retakePhoto("front", true, true);
      document.querySelector(
        "button[onclick=\"retakePhoto('top', true)\"]"
      ).onclick = () => retakePhoto("top", true, true);
      document.querySelector(
        "button[onclick=\"retakePhoto('right', true)\"]"
      ).onclick = () => retakePhoto("right", true, true);
      document.querySelector(
        "button[onclick=\"retakePhoto('left', true)\"]"
      ).onclick = () => retakePhoto("left", true, true);

      function confirmPhoto(view, returnToReviewPage = false) {
        const previewElement = document.getElementById(`${view}ViewPreview`);
        previewElement.src = capturedPhotos[view];
        if (returnToReviewPage) {
          navigateTo("page10");
        } else {
          if (view === "front") navigateTo("page5");
          if (view === "top") navigateTo("page7");
          if (view === "right") navigateTo("page9");
          if (view === "left") navigateTo("page11");
        }
      }

      // Update confirm button onclicks to include returnToReviewPage parameter
      // document.getElementById("confirmBtnFront").onclick = () =>
      //   confirmPhoto("front", true);
      // document.getElementById("confirmBtnTop").onclick = () =>
      //   confirmPhoto("top", true);
      // document.getElementById("confirmBtnRight").onclick = () =>
      //   confirmPhoto("right", true);
      // document.getElementById("confirmBtnLeft").onclick = () =>
      //   confirmPhoto("left", true);

      function sendPhotos() {
        navigateTo("page12");
        const frontViewPhoto = capturedPhotos.front;
        const topViewPhoto = capturedPhotos.top;
        fetchApiData(frontViewPhoto, topViewPhoto);
      }

      async function fetchApiData(frontViewPhoto, topViewPhoto) {
        try {
          const response = await fetch(
            "https://tv1wdm122i.execute-api.eu-west-3.amazonaws.com/default/oma",
            {
              method: "POST",
              headers: {
                "Access-Control-Allow-Origin": "*",
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                file_front: frontViewPhoto.split(",")[1],
                file_top: topViewPhoto.split(",")[1],
              }),
            }
          );

          if (!response.ok) {
            throw new Error("HTTP error! Status: ${response.status}");
          }

          const data = await response.json();
          console.log(data);
          // Store the result in local storage
          localStorage.setItem("result", JSON.stringify(data));
          displayResult(data.nordwood_scale);
          navigateTo("page13");
        } catch (error) {
          localStorage.setItem("result", "Error: ${error.message}");
        }
      }

      // Fonction pour afficher la page en fonction du résultat de l'IA
      function displayResult(result) {
        const stages = [
          {
            title: "STADE 1",
            description: "Aucune Alopécie",
            analysisResult: "Vous êtes au stade 1 sur 7 de l'Alopécie",
            analysisDescription:
              "À ce stade, vous n'avez encore <b>aucune chute de cheveux visible.</b> Attention à <b>bien surveiller les premiers signes</b> de récession de la ligne frontale, des tempes ou du sommet du crâne pour pouvoir agir rapidement si besoin et conserver toute votre belle chevelure.",
          },
          {
            title: "STADE 2",
            description: "Alopécie légère",
            analysisResult: "Vous êtes au stade 2 sur 7 de l'Alopécie",
            analysisDescription:
              "À ce stade, votre chute de cheveux se caractérise par une <b>très légère récession de la ligne frontale, des tempes ou du sommet du crâne.</b> C'est souvent à ce stade que les premiers changements peuvent passer inaperçus pour l'entourage, mais vous pouvez commencer à observer des <b>différences en comparant avec des photos anciennes.</b>",
          },
          {
            title: "STADE 3",
            description: "Alopécie modérée",
            analysisResult: "Vous êtes au stade 3 sur 7 de l'Alopécie",
            analysisDescription:
              "À ce stade, votre chute de cheveux se caractérise en général par une <b>récession de la ligne frontale,</b> des tempes qui commencent à se creuser et un <b>dégarnissement plus ou moins important sur le sommet du crâne.</b>",
          },
          {
            title: "STADE 4",
            description: "Alopécie Avancée",
            analysisResult: "Vous êtes au stade 4 sur 7 de l'Alopécie",
            analysisDescription:
              "À ce stade, votre chute de cheveux se caractérise par une <b>récession frontale plus avancée</b> et/ou un <b>dégarnissement significatif</b> au sommet du crâne. Vous pouvez encore disposer  d’une bande de cheveux séparant encore le sommet dégarnie de la récession frontale, mais celle-ci devient de plus en plus mince. <b>Votre alopécie est visible</b> pour votre entourage.",
          },
          {
            title: "STADE 5",
            description: "Forte Alopécie",
            analysisResult: "Vous êtes au stade 5 sur 7 de l'Alopécie",
            analysisDescription:
              'À ce stade, votre chute de cheveux se caractérise par une <b>récession frontale très avancée</b> et une <b>large zone dégarnie</b> au sommet du crâne. La zone dégarnie forme un grand "U" ou "O" sur le dessus de votre tête, tandis que les cheveux sur les côtés et l\'arrière restent encore présents. <b>La perte de cheveux est très visible</b> pour votre entourage.',
          },
          {
            title: "STADE 6",
            description: "Alopécie Sévère",
            analysisResult: "Vous êtes au stade 6 sur 7 de l'Alopécie",
            analysisDescription:
              "À ce stade, votre chute de cheveux se caractérise par une récession frontale et un <b>dégarnissement presque total du sommet du crâne.</b> Les cheveux restants se trouvent principalement sur les côtés et l'arrière de la tête, formant ce qu'on appelle une couronne de cheveux. Votre <b>alopécie est maintenant très avancée et extrêmement visible</b> pour votre entourage.",
          },
          {
            title: "STADE 7",
            description: "Alopécie Totale",
            analysisResult: "Vous êtes au stade 7 sur 7 de l'Alopécie",
            analysisDescription:
              "À ce stade, <b>votre chute de cheveux est à son maximum.</b> La récession frontale, les tempes et le sommet du crâne sont <b>complètement dégarnis.</b> Il ne reste pratiquement plus de cheveux sur le dessus et l'avant de votre tête. La couronne de cheveux sur les côtés et l'arrière de la tête est également très fine et clairsemée, voire totalement disparue chez certains hommes.",
          },
        ];

        const issues = [
          {
            subtitle1: "Surveiller les premiers signes de chute",
            subtitle2: "Maintenir votre chevelure en forme",
            descritpion:
              "Une prise en charge dès les premiers signes peut vous permettre de stopper la chute des cheveux et éviter de passer au stade 2 ou 3 de l’alopécie dès qu’un évènement stressant ou impactant se présentera dans votre vie, surtout s’il existe des antécédents familiaux chez vous.",
            status: "Restez alerte",
            statusDescription:
              "Surveillez les premiers signes de chute pour une prise en charge rapide et rester au stade 1 le plus longtemps possible.",
          },
          {
            subtitle1: "Freiner la Chute",
            subtitle2: "Regagner rapidement de la densité et du volume",
            descritpion:
              "Votre chute de cheveux peut rester lente et modérée mais accélérer  à tout moment dès qu’un évènement stressant ou impactant se présentera dans votre vie, et vous faire passer rapidement au stade suivant.",
            status: "Bonne nouvelle",
            statusDescription:
              "Au stade 2 de l'alopécie, c’est là qu’on obtient les meilleurs résultats : la chute peut être stoppée et on peut regagner de la densité en quelques mois.",
          },
          {
            subtitle1: "Freiner la Chute",
            subtitle2: "Regagner de la densité et du volume",
            descritpion:
              "Votre chute de cheveux peut rester lente et modérée mais accélérer  à tout moment dès qu’un évènement stressant ou impactant se présentera dans votre vie, et vous faire passer au stade suivant.",
            status: "Bonne nouvelle",
            statusDescription:
              "Au stade 3 de l'alopécie, on peut obtenir des résultats en quelques mois et sans passer par la greffe de cheveux.",
          },
          {
            subtitle1: "Freiner la Chute",
            subtitle2: "Regagner de la densité et du volume",
            descritpion:
              "Votre chute de cheveux peut rester lente mais accélérer  à tout moment dès qu’un évènement stressant ou impactant se présentera dans votre vie, et vous faire passer rapidement au stade suivant.",
            status: "Bonne nouvelle",
            statusDescription:
              "Au stade 4 de l'alopécie, on peut obtenir des résultats en quelques mois et sans passer par la greffe de cheveux.",
          },
          {
            subtitle1: "Freiner la Chute",
            subtitle2: "Trouver une solution innovante pour vos cheveux",
            descritpion:
              "Votre chute est déjà assez avancée et malheureusement les solutions cosmétiques ou médicamenteuses ne seront plus suffisantes pour retrouver une impression de chevelure dense et forte, il va donc falloir se tourner des alternatives en institut.",
            status: "Il existe des solutions",
            statusDescription:
              "Au stade 5 de l'alopécie, il est toujours possible d'obtenir des résultats significatifs avec un traitement approprié. ",
          },
          {
            subtitle1: "Envisager la greffe capillaire",
            subtitle2: "",
            descritpion:
              "Les solutions cosmétiques ou médicamenteuses ne seront plus suffisantes pour retrouver une chevelure dense et forte. Si c’est votre souhait, la seule solution qui s’impose à vous est la greffe capillaire.",
            status: "Il existe des solutions",
            statusDescription:
              "Au stade 6 de l'alopécie, il est toujours possible d'obtenir des résultats significatifs avec une greffe capillaire.",
          },
          {
            subtitle1: "Vérifier si la greffe de cheveux est encore possible",
            subtitle2: "",
            descritpion:
              "Les solutions cosmétiques ou médicamenteuses ne seront plus suffisantes pour retrouver une chevelure dense et forte. Si c’est votre souhait, la seule solution qui peut encore sauver votre chevelure est la greffe capillaire.",
            status: "Une solution est encore possible",
            statusDescription:
              "Au stade 7 de l'alopécie, il peut être encore possible d'obtenir des résultats avec le traitement approprié.  C’est notamment le cas de la greffe capillaire - sous réserve d’avoir encore une zone donneuse importante - qui vous permettra de retrouver de la densité capillaire.",
          },
        ];

        const solutions = [
          {
            title:
              "Vous n’avez pas traitement à suivre au stade 1 de l’Alopécie.",
            description:
              "Dès les premiers signes, pensez au Protocole 3-en-1 qui est une solution adaptée pour freiner la chute de cheveux et gagner en densité.",
            arg1: "<b>Efficacité scientifiquement prouvée :</b> 95% des participants à l'essai clinique ont signalé une réduction de la chute des cheveux",
            arg2: "<b>Résultats visibles en seulement 90 jours :</b> Augmentation de la repousse de +78% et baisse de la chute des cheveux de 28%",
            arg3: "<b>Garantie Satisfait ou Remboursé</b> Si aucun résultat en 90 jours",
            buttonText: "DÉCOUVRIR LE PRODUIT",
            condition: "",
          },
          {
            title:
              "Le Protocole 3-en-1 est la solution adaptée à votre chute de cheveux",
            description:
              "Une cure en <b>90 jours</b> qui va vous permettre de stopper la chute des cheveux, stimuler la pousse et gagner en densité :",
            arg1: "<b>Efficacité scientifiquement prouvée :</b> 95% des participants à l'essai clinique ont signalé une réduction de la chute des cheveux",
            arg2: "<b>Résultats visibles en seulement 90 jours :</b> Augmentation de la repousse de +78% et baisse de la chute des cheveux de 28%",
            arg3: "<b>Garantie Satisfait ou Remboursé</b> Si aucun résultat en 90 jours",
            buttonText: "DÉCOUVRIR LE PRODUIT",
            condition: "",
          },
          {
            title:
              "Le Protocole 3-en-1 est la solution adaptée à votre chute de cheveux",
            description:
              "Une cure en <b>90 jours</b> qui va vous permettre de stopper la chute des cheveux, stimuler la pousse et gagner en densité :",
            arg1: "<b>Efficacité scientifiquement prouvée :</b> 95% des participants à l'essai clinique ont signalé une réduction de la chute des cheveux",
            arg2: "<b>Résultats visibles en seulement 90 jours :</b> Augmentation de la repousse de +78% et baisse de la chute des cheveux de 28%",
            arg3: "<b>Garantie Satisfait ou Remboursé</b> Si aucun résultat en 90 jours",
            buttonText: "DÉCOUVRIR LE PRODUIT",
            condition: "",
          },
          {
            title:
              "Le Protocole 3-en-1 est la solution adaptée à votre chute de cheveux",
            description:
              "Une cure en <b>90 jours</b> qui va vous permettre de stopper la chute des cheveux, stimuler la pousse et gagner en densité :",
            arg1: "<b>Efficacité scientifiquement prouvée :</b> 95% des participants à l'essai clinique ont signalé une réduction de la chute des cheveux",
            arg2: "<b>Résultats visibles en seulement 90 jours :</b> Augmentation de la repousse de +78% et baisse de la chute des cheveux de 28%",
            arg3: "<b>Garantie Satisfait ou Remboursé</b> Si aucun résultat en 90 jours",
            buttonText: "DÉCOUVRIR LE PRODUIT",
            condition: "",
          },
          {
            title: "La Greffe Capillaire est la solution adaptée pour vous.",
            description:
              "Une intervention chirurgicale en une journée qui va vous permettre de restaurer vos cheveux, stimuler la pousse et retrouver une densité naturelle.",
            arg1: "<b>Résultats visibles en 6 à 12 mois</b> Cheveux naturels et permanents, avec une repousse continue et une densité renforcée.",
            arg2: "<b>Solution permanente :</b> optez pour une solution permanente pour combattre l'alopécie et retrouver votre chevelure originelle.",
            arg3: "<b>Besoin d’information sur la greffe capillaire ?</b> Nous vous proposons de prendre rendez-vous avec l’une de nos cliniques partenaires.",
            buttonText: "DEMANDE D'INFORMATIONS",
            condition:
              "<i>* OMA & ME est susceptible de recevoir une rémunération de la part de la clinique partenaire.</i>",
          },
          {
            title: "La Greffe Capillaire est la solution adaptée pour vous.",
            description:
              "Une intervention chirurgicale en une journée qui va vous permettre de restaurer vos cheveux, stimuler la pousse et retrouver une densité naturelle.",
            arg1: "<b>Résultats visibles en 6 à 12 mois</b> Cheveux naturels et permanents, avec une repousse continue et une densité renforcée.",
            arg2: "<b>Solution permanente :</b> optez pour une solution permanente pour combattre l'alopécie et retrouver votre chevelure originelle.",
            arg3: "<b>Besoin d’information sur la greffe capillaire ?</b> Nous vous proposons de prendre rendez-vous avec l’une de nos cliniques partenaires.",
            buttonText: "DEMANDE D'INFORMATIONS",
            condition:
              "<i>* OMA & ME est susceptible de recevoir une rémunération de la part de la clinique partenaire.</i>",
          },
          {
            title: "La Greffe Capillaire est la solution adaptée pour vous.",
            description:
              "Une intervention chirurgicale en une journée qui va vous permettre de restaurer vos cheveux, stimuler la pousse et retrouver une densité naturelle.",
            arg1: "<b>Résultats visibles en 6 à 12 mois</b> Cheveux naturels et permanents, avec une repousse continue et une densité renforcée.",
            arg2: "<b>Solution permanente :</b> optez pour une solution permanente pour combattre l'alopécie et retrouver votre chevelure originelle.",
            arg3: "<b>Besoin d’information sur la greffe capillaire ?</b> Nous vous proposons de prendre rendez-vous avec l’une de nos cliniques partenaires.",
            buttonText: "DEMANDE D'INFORMATIONS",
            condition:
              "<i>* OMA & ME est susceptible de recevoir une rémunération de la part de la clinique partenaire.</i>",
          },
        ];

        if (result < 1 || result > stages.length) {
          console.error("Résultat hors de portée");
          return;
        }

        const stage = stages[result - 1];
        document.getElementById("stage-title").innerHTML = stage.title;
        document.getElementById("stage-description").innerHTML =
          stage.description;
        document.getElementById("analysis-result").innerHTML =
          stage.analysisResult;
        document.getElementById("analysis-description").innerHTML =
          stage.analysisDescription;

        const issue = issues[result - 1];
        document.getElementById("subtitle1").innerHTML = issue.subtitle1;
        document.getElementById("subtitle2").innerHTML = issue.subtitle2;
        document.getElementById("issue-description").innerHTML =
          issue.descritpion;
        document.getElementById("issue-status").innerHTML = issue.status;
        document.getElementById("status-description").innerHTML =
          issue.statusDescription;

        const solution = solutions[result - 1];
        document.getElementById("solution-subtitle").innerHTML = solution.title;
        document.getElementById("solution-description").innerHTML =
          solution.description;
        document.getElementById("arg1").innerHTML = solution.arg1;
        document.getElementById("arg2").innerHTML = solution.arg2;
        document.getElementById("arg3").innerHTML = solution.arg3;
        document.getElementById("button-text").innerHTML = solution.buttonText;
        document.getElementById("condition").innerHTML = solution.condition;

        updateBarColors(result);
        updateImage(result);
      }

      function showText(id) {
        // Masquer toutes les divs de texte
        const texts = document.querySelectorAll(".content-div");
        texts.forEach((text) => (text.style.display = "none"));

        // Afficher la div avec l'id spécifié
        document.getElementById(id).style.display = "block";

        // Sélectionner tous les boutons
        const buttons = document.querySelectorAll(".button-item button");

        // Retirer la classe 'active' de tous les boutons
        buttons.forEach((button) => button.classList.remove("active"));

        // Ajouter la classe 'active' au bouton cliqué
        const clickedButton = Array.from(buttons).find((button) =>
          button.onclick.toString().includes(id)
        );
        if (clickedButton) {
          clickedButton.classList.add("active");
        }
      }

      function updateBarColors(input) {
        // Récupère la valeur de l'input
        const barNumber = parseInt(input);

        // Sélectionne toutes les barres
        const bars = document.querySelectorAll(".stage-bars > div");
        const numbers = document.querySelectorAll(".stage-number");

        const whiteGradient =
          "linear-gradient(180deg, rgb(255, 255, 255) 64.5%, rgba(255, 255, 255, 0) 100%)";
        const grayGradient =
          "linear-gradient(180deg, rgb(218, 213, 196) 0%, rgba(218, 213, 196, 0) 100%)";
        const blackColor = "black";

        // Parcourt les barres et met à jour leur couleur
        bars.forEach((bar, index) => {
          const barIndex = index + 1; // Les barres sont indexées à partir de 1
          if (barIndex === barNumber) {
            bar.style.background = blackColor; // Couleur pour la barre spécifiée
          } else if (barIndex < barNumber) {
            bar.style.background = grayGradient; // Couleur pour les barres avant
          } else {
            bar.style.background = whiteGradient; // Couleur pour les barres après
          }
        });
        // Parcourt les numéros et met à jour leur couleur
        numbers.forEach((number, index) => {
          const numberIndex = index + 1; // Les numéros sont indexés à partir de 1
          if (numberIndex === barNumber) {
            number.style.background = blackColor;
            number.style.color = "white";
          } else {
            number.style.background = "initial"; // Couleur par défaut pour les autres numéros
          }
        });
      }

      function updateImage(input) {
        var analysis_img = document.getElementById("analysis-ellipse-img");
        var issue_img = document.getElementById("issue-status-img");
        var solution_img = document.getElementById("solution-description-img");

        if (input == 1) {
          issue_img.src =
            "https://cdn.shopify.com/s/files/1/0232/5961/1200/files/Capture_d_ecran_2024-07-30_102737.png?v=1722328078";
        }

        analysis_img.src = `https://cdn.shopify.com/s/files/1/0232/5961/1200/files/circle-${input}.png`;

        if (input <= 4) {
          solution_img.src =
            "https://cdn.shopify.com/s/files/1/0232/5961/1200/files/kit.png?v=1722253778";
        } else {
          solution_img.src =
            "https://cdn.shopify.com/s/files/1/0232/5961/1200/files/salon.png?v=1722253770";
        }
      }

      function capitalize(string) {
        return string.charAt(0).toUpperCase() + string.slice(1);
      }

      window.addEventListener("load", () => {
        const result = localStorage.getItem("result");
        if (result) {
          document.getElementById("result").value = result;
          localStorage.removeItem("result");
        }
      });

      document.addEventListener("DOMContentLoaded", () => {
        navigateTo("page1"); // Initialiser sur la première page

        const buttons = document.querySelectorAll(".gender-btn");
        buttons.forEach((button) => {
          button.addEventListener("click", () => {
            buttons.forEach((btn) => btn.classList.remove("selected"));
            button.classList.add("selected");
          });
        });

        // Gestion de la politique de confidentialité
        const checkbox = document.getElementById("privacy-checkbox");
        const confirmButton = document.getElementById("confirm-button");

        checkbox.addEventListener("change", function () {
          if (checkbox.checked) {
            confirmButton.disabled = false;
            confirmButton.classList.add("enabled");
          } else {
            confirmButton.disabled = true;
            confirmButton.classList.remove("enabled");
          }
        });

        confirmButton.addEventListener("click", function () {
          if (checkbox.checked) {
            document.getElementById("privacy-overlay").style.display = "none";
          }
        });

        // Gestion de la section dépliante
        const collapsibleButton = document.querySelector(".collapsible-button");
        const collapsibleContent = document.querySelector(
          ".collapsible-content"
        );

        console.log("Collapsible Button:", collapsibleButton);
        console.log("Collapsible Content:", collapsibleContent);

        if (collapsibleButton && collapsibleContent) {
          collapsibleButton.addEventListener("click", () => {
            console.log("Button Clicked");
            if (collapsibleContent.style.display === "block") {
              collapsibleContent.style.display = "none";
              collapsibleButton.textContent = "+";
            } else {
              collapsibleContent.style.display = "block";
              collapsibleButton.textContent = "−";
            }
          });
        } else {
          console.error("Elements not found");
        }

        var listItems = document.querySelectorAll("#issue ul li");

        listItems.forEach(function (item) {
          if (item.textContent.trim() === "") {
            item.classList.add("hidden");
          }
        });
      });
    </script>
  </body>
</html>
