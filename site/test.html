<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>Combined Application</title>
</head>

<body>
    <!-- Page 1: Select Gender -->
    <div id="page1" class="page">
        <div class="container">
            <h1>Select Your Gender</h1>
            <p>Please select your gender and accept our Privacy Policy to continue.</p>
            <div class="gender-selection">
                <button class="gender-btn" onclick="selectGender('male')">Male</button>
                <button class="gender-btn" onclick="selectGender('female')">Female</button>
            </div>
            <p class="privacy-policy">
                By continuing, you agree to our <a href="privacy-policy.html">Privacy Policy</a>.
            </p>
        </div>
    </div>

    <!-- Page 2: Photo Instructions (Front View) -->
    <div id="page2" class="page" style="display: none;">
        <div class="container">
            <h1>Photo Instructions</h1>
            <p>Please follow the examples below to take clear and accurate photos.</p>
            <div class="photo-example">
                <h2>Front View</h2>
                <img src="front-view-example.jpg" alt="Front View Example">
            </div>
            <button class="continue-btn" onclick="navigateTo('page3')">Continue</button>
        </div>
    </div>

    <!-- Page 3: Take Front View Photo -->
    <div id="page3" class="page" style="display: none;">
        <div class="container">
            <h1>Take Your Front View Photo</h1>
            <p>Ensure your photo is clear and well-lit.</p>
            <video id="videoFront" autoplay></video>
            <button id="captureBtnFront" class="capture-btn" onclick="capturePhoto('front')">Capture Photo</button>
            <button id="retakeBtnFront" class="retake-btn" onclick="retakePhoto('front')"
                style="display:none;">Retake</button>
            <button id="confirmBtnFront" class="confirm-btn" onclick="confirmPhoto('front')"
                style="display:none;">Confirm</button>
            <canvas id="canvasFront" style="display:none;"></canvas>
        </div>
    </div>

    <!-- Page 4: Photo Instructions (Top View) -->
    <div id="page4" class="page" style="display: none;">
        <div class="container">
            <h1>Photo Instructions</h1>
            <p>Please follow the examples below to take clear and accurate photos.</p>
            <div class="photo-example">
                <h2>Top View</h2>
                <img src="top-view-example.jpg" alt="Top View Example">
            </div>
            <button class="continue-btn" onclick="navigateTo('page5')">Continue</button>
        </div>
    </div>

    <!-- Page 5: Take Top View Photo -->
    <div id="page5" class="page" style="display: none;">
        <div class="container">
            <h1>Take Your Top View Photo</h1>
            <p>Ensure your photo is clear and well-lit.</p>
            <video id="videoTop" autoplay></video>
            <button id="captureBtnTop" class="capture-btn" onclick="capturePhoto('top')">Capture Photo</button>
            <button id="retakeBtnTop" class="retake-btn" onclick="retakePhoto('top')"
                style="display:none;">Retake</button>
            <button id="confirmBtnTop" class="confirm-btn" onclick="confirmPhoto('top')"
                style="display:none;">Confirm</button>
            <canvas id="canvasTop" style="display:none;"></canvas>
        </div>
    </div>

    <!-- Page 6: Review Photos -->
    <div id="page6" class="page" style="display: none;">
        <div class="container">
            <h1>Review Your Photos</h1>
            <div class="photo-preview">
                <div>
                    <h2>Front View</h2>
                    <img id="frontViewPreview" src="" alt="Front View Photo">
                </div>
                <div>
                    <h2>Top View</h2>
                    <img id="topViewPreview" src="" alt="Top View Photo">
                </div>
            </div>
            <div class="button-group">
                <button onclick="retakePhoto('front')">Retake Front View</button>
                <button onclick="retakePhoto('top')">Retake Top View</button>
            </div>
            <div class="button-group">
                <button onclick="sendPhotos()">Send Photos</button>
            </div>
        </div>
    </div>

    <script>
        let frontPhoto = '';
        let topPhoto = '';

        function navigateTo(pageId) {
            document.querySelectorAll('.page').forEach(page => page.style.display = 'none');
            document.getElementById(pageId).style.display = 'block';
        }

        function capturePhoto(view) {
            let video = document.getElementById(`video${view.charAt(0).toUpperCase() + view.slice(1)}`);
            let canvas = document.getElementById(`canvas${view.charAt(0).toUpperCase() + view.slice(1)}`);
            let captureBtn = document.getElementById(`captureBtn${view.charAt(0).toUpperCase() + view.slice(1)}`);
            let retakeBtn = document.getElementById(`retakeBtn${view.charAt(0).toUpperCase() + view.slice(1)}`);
            let confirmBtn = document.getElementById(`confirmBtn${view.charAt(0).toUpperCase() + view.slice(1)}`);

            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
            let photoData = canvas.toDataURL('image/png');

            if (view === 'front') {
                frontPhoto = photoData;
            } else if (view === 'top') {
                topPhoto = photoData;
            }

            captureBtn.style.display = 'none';
            retakeBtn.style.display = 'inline-block';
            confirmBtn.style.display = 'inline-block';
        }

        function retakePhoto(view) {
            let captureBtn = document.getElementById(`captureBtn${view.charAt(0).toUpperCase() + view.slice(1)}`);
            let retakeBtn = document.getElementById(`retakeBtn${view.charAt(0).toUpperCase() + view.slice(1)}`);
            let confirmBtn = document.getElementById(`confirmBtn${view.charAt(0).toUpperCase() + view.slice(1)}`);

            captureBtn.style.display = 'inline-block';
            retakeBtn.style.display = 'none';
            confirmBtn.style.display = 'none';

            if (view === 'front') {
                frontPhoto = '';
            } else if (view === 'top') {
                topPhoto = '';
            }
        }

        function confirmPhoto(view) {
            if (view === 'front') {
                navigateTo('page4');
            } else if (view === 'top') {
                navigateTo('page6');
                document.getElementById('frontViewPreview').src = frontPhoto;
                document.getElementById('topViewPreview').src = topPhoto;
            }
        }

        function sendPhotos() {
            // Logic to send photos to the server
            console.log('Sending photos:', { frontPhoto, topPhoto });
        }

        document.addEventListener('DOMContentLoaded', () => {
            let videoFront = document.getElementById('videoFront');
            let videoTop = document.getElementById('videoTop');

            navigator.mediaDevices.getUserMedia({ video: true }).then(stream => {
                videoFront.srcObject = stream;
                videoTop.srcObject = stream;
            }).catch(err => console.error('Error accessing webcam:', err));
        });
    </script>
</body>

</html>